function AppDataModel(){var e=this;e.userInfoUrl="/api/Me",e.siteUrl="/",e.returnUrl=e.siteUrl,e.setAccessToken=function(e){sessionStorage.setItem("accessToken",e)},e.getAccessToken=function(){return sessionStorage.getItem("accessToken")}}function AppViewModel(e){var n=this;n.Views={Loading:{}},n.dataModel=e,n.view=ko.observable(n.Views.Loading),n.loading=ko.computed(function(){return n.view()===n.Views.Loading}),n.addViewModel=function(o){var t,i=new o.factory(n,e);n.Views[o.name]=i,n[o.bindingMemberName]=ko.computed(function(){if(!e.getAccessToken()){var t=common.getFragment();t.access_token?(window.location.hash=t.state||"",e.setAccessToken(t.access_token)):window.location="/Account/Authorize?client_id=web&response_type=token&state="+encodeURIComponent(window.location.hash)}return n.Views[o.name]}),t=void 0!==o.navigatorFactory?o.navigatorFactory(n,e):function(){window.location.hash=o.bindingMemberName},n["navigateTo"+o.name]=t},n.initialize=function(){Sammy().run()}}function HomeViewModel(e,n){var o=this;return o.myHometown=ko.observable(""),Sammy(function(){this.get("#home",function(){$.ajax({method:"get",url:e.dataModel.userInfoUrl,contentType:"application/json; charset=utf-8",headers:{Authorization:"Bearer "+e.dataModel.getAccessToken()},success:function(e){o.myHometown("Your Hometown is : "+e.hometown)}})}),this.get("/",function(){this.app.runRoute("get","#home")})}),o}var app=new AppViewModel(new AppDataModel);window.common=function(){function e(e){var n,o,t,i,a,s,r,c={};if(null===e)return c;n=e.split("&");for(var d=0;d<n.length;d++)-1===(t=(o=n[d]).indexOf("="))?(i=o,a=null):(i=o.substr(0,t),a=o.substr(t+1)),s=decodeURIComponent(i),r=decodeURIComponent(a),c[s]=r;return c}var n={};return n.getFragment=function(){return 0===window.location.hash.indexOf("#")?e(window.location.hash.substr(1)):{}},n}(),app.addViewModel({name:"Home",bindingMemberName:"home",factory:HomeViewModel}),$(function(){app.initialize(),ko.validation.init({grouping:{observable:!1}}),ko.applyBindings(app)});